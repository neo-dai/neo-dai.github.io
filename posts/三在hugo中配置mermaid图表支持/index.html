<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>在Hugo中配置Mermaid图表支持 | Notes</title><meta name=keywords content><meta name=description content="Mermaid是一个强大的图表和流程图生成工具，可以通过简单的文本语法创建各种图表。在Hugo博客中集成Mermaid支持，可以让你在Markdown文章中直接绘制流程图、时序图、甘特图等，极大提升技术文档的可读性和专业性。
为什么选择Mermaid？

纯文本语法：使用Markdown类似的语法，无需图形界面工具
版本控制友好：图表代码可以像代码一样进行版本管理
多种图表类型：支持流程图、时序图、甘特图、类图、状态图等
自动渲染：在浏览器中自动渲染为SVG矢量图

配置流程概览
在Hugo中配置Mermaid支持的整体流程如下：
graph TD
  A[开始配置] --> B[创建Render Hook]
  B --> C[添加Mermaid脚本]
  C --> D[配置Hugo Markup]
  D --> E[测试渲染]
  E --> F{渲染成功?}
  F -->|是| G[完成配置]
  F -->|否| H[排查问题]
  H --> D

详细配置步骤
1. 创建Mermaid Render Hook
Hugo使用Render Hook来自定义代码块的渲染方式。我们需要创建一个专门的hook来处理mermaid代码块。
在项目根目录下创建以下文件：
文件路径：layouts/_default/_markup/render-codeblock-mermaid.html
文件内容：
<div class=&#34;mermaid&#34;>
{{- .Inner -}}
</div>
这个文件的作用是：当Hugo遇到 ```mermaid 代码块时，会将其转换为 <div class=&#34;mermaid&#34;> 元素，而不是普通的代码块。
2. 添加Mermaid JavaScript支持
接下来需要在页面中加载Mermaid的JavaScript库，并初始化渲染。
文件路径：layouts/partials/extend_footer.html
文件内容：
{{- /* Footer custom content area start */ -}}
{{- /* 添加Mermaid支持 */ -}}
<script src=&#34;https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js&#34;></script>
<script>
  // 初始化mermaid并渲染页面中的所有mermaid图表
  mermaid.initialize({ 
    startOnLoad: true, 
    theme: 'default',
    securityLevel: 'loose'
  });
  // 确保所有mermaid元素都被渲染
  if (document.querySelectorAll('.mermaid').length > 0) {
    mermaid.run();
  }
</script>
{{- /* Footer custom content area end */ -}}
说明："><meta name=author content="neo"><link rel=canonical href=https://neo-dai.github.io/posts/%E4%B8%89%E5%9C%A8hugo%E4%B8%AD%E9%85%8D%E7%BD%AEmermaid%E5%9B%BE%E8%A1%A8%E6%94%AF%E6%8C%81/><link crossorigin=anonymous href=/assets/css/stylesheet.b4dfb58bc1aadc21cb0542f53df82233971252c1283b7ff385ac519b35b25bc3.css integrity="sha256-tN+1i8Gq3CHLBUL1PfgiM5cSUsEoO3/zhaxRmzWyW8M=" rel="preload stylesheet" as=style><link rel=icon href=https://neo-dai.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://neo-dai.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://neo-dai.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://neo-dai.github.io/apple-touch-icon.png><link rel=mask-icon href=https://neo-dai.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://neo-dai.github.io/posts/%E4%B8%89%E5%9C%A8hugo%E4%B8%AD%E9%85%8D%E7%BD%AEmermaid%E5%9B%BE%E8%A1%A8%E6%94%AF%E6%8C%81/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script src=https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0,theme:"default",securityLevel:"loose"})</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;500;600;700&display=swap" rel=stylesheet><meta property="og:url" content="https://neo-dai.github.io/posts/%E4%B8%89%E5%9C%A8hugo%E4%B8%AD%E9%85%8D%E7%BD%AEmermaid%E5%9B%BE%E8%A1%A8%E6%94%AF%E6%8C%81/"><meta property="og:site_name" content="Notes"><meta property="og:title" content="在Hugo中配置Mermaid图表支持"><meta property="og:description" content="Mermaid是一个强大的图表和流程图生成工具，可以通过简单的文本语法创建各种图表。在Hugo博客中集成Mermaid支持，可以让你在Markdown文章中直接绘制流程图、时序图、甘特图等，极大提升技术文档的可读性和专业性。
为什么选择Mermaid？ 纯文本语法：使用Markdown类似的语法，无需图形界面工具 版本控制友好：图表代码可以像代码一样进行版本管理 多种图表类型：支持流程图、时序图、甘特图、类图、状态图等 自动渲染：在浏览器中自动渲染为SVG矢量图 配置流程概览 在Hugo中配置Mermaid支持的整体流程如下：
graph TD A[开始配置] --> B[创建Render Hook] B --> C[添加Mermaid脚本] C --> D[配置Hugo Markup] D --> E[测试渲染] E --> F{渲染成功?} F -->|是| G[完成配置] F -->|否| H[排查问题] H --> D 详细配置步骤 1. 创建Mermaid Render Hook Hugo使用Render Hook来自定义代码块的渲染方式。我们需要创建一个专门的hook来处理mermaid代码块。
在项目根目录下创建以下文件：
文件路径：layouts/_default/_markup/render-codeblock-mermaid.html
文件内容：
<div class=&#34;mermaid&#34;> {{- .Inner -}} </div> 这个文件的作用是：当Hugo遇到 ```mermaid 代码块时，会将其转换为 <div class=&#34;mermaid&#34;> 元素，而不是普通的代码块。
2. 添加Mermaid JavaScript支持 接下来需要在页面中加载Mermaid的JavaScript库，并初始化渲染。
文件路径：layouts/partials/extend_footer.html
文件内容：
{{- /* Footer custom content area start */ -}} {{- /* 添加Mermaid支持 */ -}} <script src=&#34;https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js&#34;></script> <script> // 初始化mermaid并渲染页面中的所有mermaid图表 mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'loose' }); // 确保所有mermaid元素都被渲染 if (document.querySelectorAll('.mermaid').length > 0) { mermaid.run(); } </script> {{- /* Footer custom content area end */ -}} 说明："><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-01-27T10:00:00+08:00"><meta property="article:modified_time" content="2025-01-27T10:00:00+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="在Hugo中配置Mermaid图表支持"><meta name=twitter:description content="Mermaid是一个强大的图表和流程图生成工具，可以通过简单的文本语法创建各种图表。在Hugo博客中集成Mermaid支持，可以让你在Markdown文章中直接绘制流程图、时序图、甘特图等，极大提升技术文档的可读性和专业性。
为什么选择Mermaid？

纯文本语法：使用Markdown类似的语法，无需图形界面工具
版本控制友好：图表代码可以像代码一样进行版本管理
多种图表类型：支持流程图、时序图、甘特图、类图、状态图等
自动渲染：在浏览器中自动渲染为SVG矢量图

配置流程概览
在Hugo中配置Mermaid支持的整体流程如下：
graph TD
  A[开始配置] --> B[创建Render Hook]
  B --> C[添加Mermaid脚本]
  C --> D[配置Hugo Markup]
  D --> E[测试渲染]
  E --> F{渲染成功?}
  F -->|是| G[完成配置]
  F -->|否| H[排查问题]
  H --> D

详细配置步骤
1. 创建Mermaid Render Hook
Hugo使用Render Hook来自定义代码块的渲染方式。我们需要创建一个专门的hook来处理mermaid代码块。
在项目根目录下创建以下文件：
文件路径：layouts/_default/_markup/render-codeblock-mermaid.html
文件内容：
<div class=&#34;mermaid&#34;>
{{- .Inner -}}
</div>
这个文件的作用是：当Hugo遇到 ```mermaid 代码块时，会将其转换为 <div class=&#34;mermaid&#34;> 元素，而不是普通的代码块。
2. 添加Mermaid JavaScript支持
接下来需要在页面中加载Mermaid的JavaScript库，并初始化渲染。
文件路径：layouts/partials/extend_footer.html
文件内容：
{{- /* Footer custom content area start */ -}}
{{- /* 添加Mermaid支持 */ -}}
<script src=&#34;https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js&#34;></script>
<script>
  // 初始化mermaid并渲染页面中的所有mermaid图表
  mermaid.initialize({ 
    startOnLoad: true, 
    theme: 'default',
    securityLevel: 'loose'
  });
  // 确保所有mermaid元素都被渲染
  if (document.querySelectorAll('.mermaid').length > 0) {
    mermaid.run();
  }
</script>
{{- /* Footer custom content area end */ -}}
说明："><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://neo-dai.github.io/posts/"},{"@type":"ListItem","position":2,"name":"在Hugo中配置Mermaid图表支持","item":"https://neo-dai.github.io/posts/%E4%B8%89%E5%9C%A8hugo%E4%B8%AD%E9%85%8D%E7%BD%AEmermaid%E5%9B%BE%E8%A1%A8%E6%94%AF%E6%8C%81/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"在Hugo中配置Mermaid图表支持","name":"在Hugo中配置Mermaid图表支持","description":"Mermaid是一个强大的图表和流程图生成工具，可以通过简单的文本语法创建各种图表。在Hugo博客中集成Mermaid支持，可以让你在Markdown文章中直接绘制流程图、时序图、甘特图等，极大提升技术文档的可读性和专业性。\n为什么选择Mermaid？ 纯文本语法：使用Markdown类似的语法，无需图形界面工具 版本控制友好：图表代码可以像代码一样进行版本管理 多种图表类型：支持流程图、时序图、甘特图、类图、状态图等 自动渲染：在浏览器中自动渲染为SVG矢量图 配置流程概览 在Hugo中配置Mermaid支持的整体流程如下：\ngraph TD A[开始配置] --\u0026gt; B[创建Render Hook] B --\u0026gt; C[添加Mermaid脚本] C --\u0026gt; D[配置Hugo Markup] D --\u0026gt; E[测试渲染] E --\u0026gt; F{渲染成功?} F --\u0026gt;|是| G[完成配置] F --\u0026gt;|否| H[排查问题] H --\u0026gt; D 详细配置步骤 1. 创建Mermaid Render Hook Hugo使用Render Hook来自定义代码块的渲染方式。我们需要创建一个专门的hook来处理mermaid代码块。\n在项目根目录下创建以下文件：\n文件路径：layouts/_default/_markup/render-codeblock-mermaid.html\n文件内容：\n\u0026lt;div class=\u0026#34;mermaid\u0026#34;\u0026gt; {{- .Inner -}} \u0026lt;/div\u0026gt; 这个文件的作用是：当Hugo遇到 ```mermaid 代码块时，会将其转换为 \u0026lt;div class=\u0026quot;mermaid\u0026quot;\u0026gt; 元素，而不是普通的代码块。\n2. 添加Mermaid JavaScript支持 接下来需要在页面中加载Mermaid的JavaScript库，并初始化渲染。\n文件路径：layouts/partials/extend_footer.html\n文件内容：\n{{- /* Footer custom content area start */ -}} {{- /* 添加Mermaid支持 */ -}} \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; // 初始化mermaid并渲染页面中的所有mermaid图表 mermaid.initialize({ startOnLoad: true, theme: \u0026#39;default\u0026#39;, securityLevel: \u0026#39;loose\u0026#39; }); // 确保所有mermaid元素都被渲染 if (document.querySelectorAll(\u0026#39;.mermaid\u0026#39;).length \u0026gt; 0) { mermaid.run(); } \u0026lt;/script\u0026gt; {{- /* Footer custom content area end */ -}} 说明：\n","keywords":[],"articleBody":"Mermaid是一个强大的图表和流程图生成工具，可以通过简单的文本语法创建各种图表。在Hugo博客中集成Mermaid支持，可以让你在Markdown文章中直接绘制流程图、时序图、甘特图等，极大提升技术文档的可读性和专业性。\n为什么选择Mermaid？ 纯文本语法：使用Markdown类似的语法，无需图形界面工具 版本控制友好：图表代码可以像代码一样进行版本管理 多种图表类型：支持流程图、时序图、甘特图、类图、状态图等 自动渲染：在浏览器中自动渲染为SVG矢量图 配置流程概览 在Hugo中配置Mermaid支持的整体流程如下：\ngraph TD A[开始配置] --\u003e B[创建Render Hook] B --\u003e C[添加Mermaid脚本] C --\u003e D[配置Hugo Markup] D --\u003e E[测试渲染] E --\u003e F{渲染成功?} F --\u003e|是| G[完成配置] F --\u003e|否| H[排查问题] H --\u003e D 详细配置步骤 1. 创建Mermaid Render Hook Hugo使用Render Hook来自定义代码块的渲染方式。我们需要创建一个专门的hook来处理mermaid代码块。\n在项目根目录下创建以下文件：\n文件路径：layouts/_default/_markup/render-codeblock-mermaid.html\n文件内容：\n\u003cdiv class=\"mermaid\"\u003e {{- .Inner -}} \u003c/div\u003e 这个文件的作用是：当Hugo遇到 ```mermaid 代码块时，会将其转换为 元素，而不是普通的代码块。\n2. 添加Mermaid JavaScript支持 接下来需要在页面中加载Mermaid的JavaScript库，并初始化渲染。\n文件路径：layouts/partials/extend_footer.html\n文件内容：\n{{- /* Footer custom content area start */ -}} {{- /* 添加Mermaid支持 */ -}} \u003cscript src=\"https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js\"\u003e\u003c/script\u003e \u003cscript\u003e // 初始化mermaid并渲染页面中的所有mermaid图表 mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'loose' }); // 确保所有mermaid元素都被渲染 if (document.querySelectorAll('.mermaid').length \u003e 0) { mermaid.run(); } \u003c/script\u003e {{- /* Footer custom content area end */ -}} 说明：\n使用CDN加载Mermaid库（版本10） startOnLoad: true 表示页面加载时自动渲染 securityLevel: 'loose' 允许更灵活的配置 mermaid.run() 确保所有mermaid元素都被正确渲染 3. 配置Hugo Markup设置 在Hugo配置文件中启用必要的markup设置。\n文件路径：hugo.toml（或config.toml）\n在配置文件中添加以下内容：\n# 启用Mermaid支持 [markup] [markup.highlight] # 代码高亮配置 noClasses = false [markup.goldmark] [markup.goldmark.renderer] # 启用不安全的HTML渲染（mermaid需要） unsafe = true 重要：unsafe = true 是必需的，因为Mermaid需要渲染HTML内容。\n4. 在文章中使用Mermaid 配置完成后，你就可以在Markdown文章中使用Mermaid语法了：\n```mermaid graph TD A[开始] --\u003e B{判断条件} B --\u003e|是| C[执行操作A] B --\u003e|否| D[执行操作B] C --\u003e E[结束] D --\u003e E ``` 渲染效果：\ngraph TD A[开始] --\u003e B{判断条件} B --\u003e|是| C[执行操作A] B --\u003e|否| D[执行操作B] C --\u003e E[结束] D --\u003e E Mermaid图表类型示例 流程图（Flowchart） graph LR A[用户] --\u003e B[登录系统] B --\u003e C{验证成功?} C --\u003e|是| D[进入主页] C --\u003e|否| E[显示错误] E --\u003e B 时序图（Sequence Diagram） sequenceDiagram participant 用户 participant 前端 participant 后端 participant 数据库 用户-\u003e\u003e前端: 提交请求 前端-\u003e\u003e后端: 发送API请求 后端-\u003e\u003e数据库: 查询数据 数据库--\u003e\u003e后端: 返回结果 后端--\u003e\u003e前端: 返回JSON 前端--\u003e\u003e用户: 显示结果 甘特图（Gantt Chart） gantt title 项目开发计划 dateFormat YYYY-MM-DD section 设计阶段 需求分析 :a1, 2025-01-01, 5d 原型设计 :a2, after a1, 3d section 开发阶段 前端开发 :b1, after a2, 10d 后端开发 :b2, after a2, 12d section 测试阶段 功能测试 :c1, after b1, 5d 上线部署 :c2, after c1, 2d 常见问题排查 问题1：图表不显示 可能原因：\nMermaid脚本未正确加载 Render Hook文件路径不正确 浏览器控制台有JavaScript错误 解决方法：\n检查浏览器控制台的错误信息 确认 layouts/_default/_markup/render-codeblock-mermaid.html 文件存在 确认 layouts/partials/extend_footer.html 文件存在且包含mermaid脚本 检查网络连接，确保能访问CDN 问题2：图表显示为代码块 可能原因：\nRender Hook未生效 Hugo配置中的 unsafe = true 未设置 解决方法：\n确认 hugo.toml 中 markup.goldmark.renderer.unsafe = true 重新构建站点：hugo --minify 清除浏览器缓存 问题3：主题切换后图表样式异常 解决方法： 可以在mermaid初始化时配置主题：\nmermaid.initialize({ startOnLoad: true, theme: 'dark', // 或 'default', 'forest', 'neutral' securityLevel: 'loose' }); 高级配置 自定义Mermaid样式 可以通过CSS自定义Mermaid图表的样式：\n.mermaid { text-align: center; margin: 20px 0; } .mermaid svg { max-width: 100%; height: auto; } 响应式支持 确保Mermaid图表在移动设备上正常显示：\nmermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'loose', flowchart: { useMaxWidth: true, htmlLabels: true } }); 总结 通过以上步骤，你已经成功在Hugo博客中配置了Mermaid支持。现在可以：\n✅ 在Markdown文章中使用Mermaid语法绘制各种图表\n✅ 图表会自动渲染为美观的SVG矢量图\n✅ 支持多种图表类型：流程图、时序图、甘特图等\n✅ 图表代码可以版本控制，便于协作和维护\n参考资源 Mermaid官方文档 Mermaid语法指南 Hugo Render Hooks文档 PaperMod主题文档 提示：如果你使用的是其他Hugo主题，配置步骤基本相同，只需要确保主题支持自定义partials和render hooks即可。\n","wordCount":"376","inLanguage":"en","datePublished":"2025-01-27T10:00:00+08:00","dateModified":"2025-01-27T10:00:00+08:00","author":{"@type":"Person","name":"neo"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://neo-dai.github.io/posts/%E4%B8%89%E5%9C%A8hugo%E4%B8%AD%E9%85%8D%E7%BD%AEmermaid%E5%9B%BE%E8%A1%A8%E6%94%AF%E6%8C%81/"},"publisher":{"@type":"Organization","name":"Notes","logo":{"@type":"ImageObject","url":"https://neo-dai.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://neo-dai.github.io/ accesskey=h title="Notes (Alt + H)">Notes</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://neo-dai.github.io/ title=首页><span>首页</span></a></li><li><a href=https://neo-dai.github.io/posts/ title=文章><span>文章</span></a></li><li><a href=https://neo-dai.github.io/series/ title=专栏><span>专栏</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">在Hugo中配置Mermaid图表支持</h1><div class=post-meta><span title='2025-01-27 10:00:00 +0800 +0800'>2025年1月27日</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>neo</span></div></header><div class=post-content><p>Mermaid是一个强大的图表和流程图生成工具，可以通过简单的文本语法创建各种图表。在Hugo博客中集成Mermaid支持，可以让你在Markdown文章中直接绘制流程图、时序图、甘特图等，极大提升技术文档的可读性和专业性。</p><h2 id=为什么选择mermaid>为什么选择Mermaid？<a hidden class=anchor aria-hidden=true href=#为什么选择mermaid>#</a></h2><ul><li><strong>纯文本语法</strong>：使用Markdown类似的语法，无需图形界面工具</li><li><strong>版本控制友好</strong>：图表代码可以像代码一样进行版本管理</li><li><strong>多种图表类型</strong>：支持流程图、时序图、甘特图、类图、状态图等</li><li><strong>自动渲染</strong>：在浏览器中自动渲染为SVG矢量图</li></ul><h2 id=配置流程概览>配置流程概览<a hidden class=anchor aria-hidden=true href=#配置流程概览>#</a></h2><p>在Hugo中配置Mermaid支持的整体流程如下：</p><div class=mermaid>graph TD
A[开始配置] --> B[创建Render Hook]
B --> C[添加Mermaid脚本]
C --> D[配置Hugo Markup]
D --> E[测试渲染]
E --> F{渲染成功?}
F -->|是| G[完成配置]
F -->|否| H[排查问题]
H --> D</div><h2 id=详细配置步骤>详细配置步骤<a hidden class=anchor aria-hidden=true href=#详细配置步骤>#</a></h2><h3 id=1-创建mermaid-render-hook>1. 创建Mermaid Render Hook<a hidden class=anchor aria-hidden=true href=#1-创建mermaid-render-hook>#</a></h3><p>Hugo使用Render Hook来自定义代码块的渲染方式。我们需要创建一个专门的hook来处理mermaid代码块。</p><p>在项目根目录下创建以下文件：</p><p><strong>文件路径</strong>：<code>layouts/_default/_markup/render-codeblock-mermaid.html</code></p><p><strong>文件内容</strong>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;mermaid&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{{- .Inner -}}
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>这个文件的作用是：当Hugo遇到 <code>```mermaid</code> 代码块时，会将其转换为 <code>&lt;div class="mermaid"></code> 元素，而不是普通的代码块。</p><h3 id=2-添加mermaid-javascript支持>2. 添加Mermaid JavaScript支持<a hidden class=anchor aria-hidden=true href=#2-添加mermaid-javascript支持>#</a></h3><p>接下来需要在页面中加载Mermaid的JavaScript库，并初始化渲染。</p><p><strong>文件路径</strong>：<code>layouts/partials/extend_footer.html</code></p><p><strong>文件内容</strong>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{{- /* Footer custom content area start */ -}}
</span></span><span class=line><span class=cl>{{- /* 添加Mermaid支持 */ -}}
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 初始化mermaid并渲染页面中的所有mermaid图表
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>mermaid</span><span class=p>.</span><span class=nx>initialize</span><span class=p>({</span> 
</span></span><span class=line><span class=cl>    <span class=nx>startOnLoad</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=nx>theme</span><span class=o>:</span> <span class=s1>&#39;default&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>securityLevel</span><span class=o>:</span> <span class=s1>&#39;loose&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 确保所有mermaid元素都被渲染
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>querySelectorAll</span><span class=p>(</span><span class=s1>&#39;.mermaid&#39;</span><span class=p>).</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>mermaid</span><span class=p>.</span><span class=nx>run</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{{- /* Footer custom content area end */ -}}
</span></span></code></pre></div><p><strong>说明</strong>：</p><ul><li>使用CDN加载Mermaid库（版本10）</li><li><code>startOnLoad: true</code> 表示页面加载时自动渲染</li><li><code>securityLevel: 'loose'</code> 允许更灵活的配置</li><li><code>mermaid.run()</code> 确保所有mermaid元素都被正确渲染</li></ul><h3 id=3-配置hugo-markup设置>3. 配置Hugo Markup设置<a hidden class=anchor aria-hidden=true href=#3-配置hugo-markup设置>#</a></h3><p>在Hugo配置文件中启用必要的markup设置。</p><p><strong>文件路径</strong>：<code>hugo.toml</code>（或<code>config.toml</code>）</p><p>在配置文件中添加以下内容：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=c># 启用Mermaid支持</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>markup</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nx>markup</span><span class=p>.</span><span class=nx>highlight</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c># 代码高亮配置</span>
</span></span><span class=line><span class=cl>    <span class=nx>noClasses</span> <span class=p>=</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nx>markup</span><span class=p>.</span><span class=nx>goldmark</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nx>markup</span><span class=p>.</span><span class=nx>goldmark</span><span class=p>.</span><span class=nx>renderer</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=c># 启用不安全的HTML渲染（mermaid需要）</span>
</span></span><span class=line><span class=cl>      <span class=nx>unsafe</span> <span class=p>=</span> <span class=kc>true</span>
</span></span></code></pre></div><p><strong>重要</strong>：<code>unsafe = true</code> 是必需的，因为Mermaid需要渲染HTML内容。</p><h3 id=4-在文章中使用mermaid>4. 在文章中使用Mermaid<a hidden class=anchor aria-hidden=true href=#4-在文章中使用mermaid>#</a></h3><p>配置完成后，你就可以在Markdown文章中使用Mermaid语法了：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=s>```mermaid
</span></span></span><span class=line><span class=cl><span class=s></span>graph TD
</span></span><span class=line><span class=cl>  A[开始] --&gt; B{判断条件}
</span></span><span class=line><span class=cl>  B --&gt;|是| C[执行操作A]
</span></span><span class=line><span class=cl>  B --&gt;|否| D[执行操作B]
</span></span><span class=line><span class=cl>  C --&gt; E[结束]
</span></span><span class=line><span class=cl>  D --&gt; E
</span></span><span class=line><span class=cl><span class=s>```</span>
</span></span></code></pre></div><p>渲染效果：</p><div class=mermaid>graph TD
A[开始] --> B{判断条件}
B -->|是| C[执行操作A]
B -->|否| D[执行操作B]
C --> E[结束]
D --> E</div><h2 id=mermaid图表类型示例>Mermaid图表类型示例<a hidden class=anchor aria-hidden=true href=#mermaid图表类型示例>#</a></h2><h3 id=流程图flowchart>流程图（Flowchart）<a hidden class=anchor aria-hidden=true href=#流程图flowchart>#</a></h3><div class=mermaid>graph LR
A[用户] --> B[登录系统]
B --> C{验证成功?}
C -->|是| D[进入主页]
C -->|否| E[显示错误]
E --> B</div><h3 id=时序图sequence-diagram>时序图（Sequence Diagram）<a hidden class=anchor aria-hidden=true href=#时序图sequence-diagram>#</a></h3><div class=mermaid>sequenceDiagram
participant 用户
participant 前端
participant 后端
participant 数据库
用户->>前端: 提交请求
前端->>后端: 发送API请求
后端->>数据库: 查询数据
数据库-->>后端: 返回结果
后端-->>前端: 返回JSON
前端-->>用户: 显示结果</div><h3 id=甘特图gantt-chart>甘特图（Gantt Chart）<a hidden class=anchor aria-hidden=true href=#甘特图gantt-chart>#</a></h3><div class=mermaid>gantt
title 项目开发计划
dateFormat YYYY-MM-DD
section 设计阶段
需求分析 :a1, 2025-01-01, 5d
原型设计 :a2, after a1, 3d
section 开发阶段
前端开发 :b1, after a2, 10d
后端开发 :b2, after a2, 12d
section 测试阶段
功能测试 :c1, after b1, 5d
上线部署 :c2, after c1, 2d</div><h2 id=常见问题排查>常见问题排查<a hidden class=anchor aria-hidden=true href=#常见问题排查>#</a></h2><h3 id=问题1图表不显示>问题1：图表不显示<a hidden class=anchor aria-hidden=true href=#问题1图表不显示>#</a></h3><p><strong>可能原因</strong>：</p><ul><li>Mermaid脚本未正确加载</li><li>Render Hook文件路径不正确</li><li>浏览器控制台有JavaScript错误</li></ul><p><strong>解决方法</strong>：</p><ol><li>检查浏览器控制台的错误信息</li><li>确认 <code>layouts/_default/_markup/render-codeblock-mermaid.html</code> 文件存在</li><li>确认 <code>layouts/partials/extend_footer.html</code> 文件存在且包含mermaid脚本</li><li>检查网络连接，确保能访问CDN</li></ol><h3 id=问题2图表显示为代码块>问题2：图表显示为代码块<a hidden class=anchor aria-hidden=true href=#问题2图表显示为代码块>#</a></h3><p><strong>可能原因</strong>：</p><ul><li>Render Hook未生效</li><li>Hugo配置中的 <code>unsafe = true</code> 未设置</li></ul><p><strong>解决方法</strong>：</p><ol><li>确认 <code>hugo.toml</code> 中 <code>markup.goldmark.renderer.unsafe = true</code></li><li>重新构建站点：<code>hugo --minify</code></li><li>清除浏览器缓存</li></ol><h3 id=问题3主题切换后图表样式异常>问题3：主题切换后图表样式异常<a hidden class=anchor aria-hidden=true href=#问题3主题切换后图表样式异常>#</a></h3><p><strong>解决方法</strong>：
可以在mermaid初始化时配置主题：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>mermaid</span><span class=p>.</span><span class=nx>initialize</span><span class=p>({</span> 
</span></span><span class=line><span class=cl>  <span class=nx>startOnLoad</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=nx>theme</span><span class=o>:</span> <span class=s1>&#39;dark&#39;</span><span class=p>,</span>  <span class=c1>// 或 &#39;default&#39;, &#39;forest&#39;, &#39;neutral&#39;
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>securityLevel</span><span class=o>:</span> <span class=s1>&#39;loose&#39;</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><h2 id=高级配置>高级配置<a hidden class=anchor aria-hidden=true href=#高级配置>#</a></h2><h3 id=自定义mermaid样式>自定义Mermaid样式<a hidden class=anchor aria-hidden=true href=#自定义mermaid样式>#</a></h3><p>可以通过CSS自定义Mermaid图表的样式：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=p>.</span><span class=nc>mermaid</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>text-align</span><span class=p>:</span> <span class=kc>center</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>margin</span><span class=p>:</span> <span class=mi>20</span><span class=kt>px</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>mermaid</span> <span class=nt>svg</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>max-width</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>height</span><span class=p>:</span> <span class=kc>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=响应式支持>响应式支持<a hidden class=anchor aria-hidden=true href=#响应式支持>#</a></h3><p>确保Mermaid图表在移动设备上正常显示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>mermaid</span><span class=p>.</span><span class=nx>initialize</span><span class=p>({</span> 
</span></span><span class=line><span class=cl>  <span class=nx>startOnLoad</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=nx>theme</span><span class=o>:</span> <span class=s1>&#39;default&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>securityLevel</span><span class=o>:</span> <span class=s1>&#39;loose&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>flowchart</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>useMaxWidth</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>htmlLabels</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><h2 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h2><p>通过以上步骤，你已经成功在Hugo博客中配置了Mermaid支持。现在可以：</p><p>✅ 在Markdown文章中使用Mermaid语法绘制各种图表<br>✅ 图表会自动渲染为美观的SVG矢量图<br>✅ 支持多种图表类型：流程图、时序图、甘特图等<br>✅ 图表代码可以版本控制，便于协作和维护</p><h2 id=参考资源>参考资源<a hidden class=anchor aria-hidden=true href=#参考资源>#</a></h2><ul><li><a href=https://mermaid.js.org/>Mermaid官方文档</a></li><li><a href=https://mermaid.js.org/intro/syntax-reference.html>Mermaid语法指南</a></li><li><a href=https://gohugo.io/templates/render-hooks/>Hugo Render Hooks文档</a></li><li><a href=https://github.com/adityatelange/hugo-PaperMod/wiki>PaperMod主题文档</a></li></ul><hr><blockquote><p><strong>提示</strong>：如果你使用的是其他Hugo主题，配置步骤基本相同，只需要确保主题支持自定义partials和render hooks即可。</p></blockquote></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://neo-dai.github.io/>Notes</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0,theme:"default",securityLevel:"loose"}),document.querySelectorAll(".mermaid").length>0&&mermaid.run()</script><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>